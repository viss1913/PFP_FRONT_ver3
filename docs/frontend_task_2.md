# ТЗ для фронтенд-разработки: Управление клиентами (v2)

Бэкенд обновлен для поддержки полноценного жизненного цикла клиента. Ниже описаны изменения в API и логике интеграции.

## 1. Идентификация (UUID)
При создании или обновлении клиента фронтенд может передавать свой уникальный ID.
- **Поле:** `client.uuid` (строка, например UUID v4).
- **Зачем:** Позволяет фронту знать ID объекта еще до того, как он попадет в БД, что удобно для оффлайн-работы или кэширования.
- **Опционально:** Если не передавать, бэкенд будет использовать только свой внутренний `id`.

## 2. Список клиентов (Dashboard)
Эндпоинт: `GET /api/client/agent-clients`
- **Поиск:** Добавьте строку поиска. При вводе отправляйте запрос с параметром `?search=текст`. Поиск идет по ФИО, телефону, Email и UUID.
- **Пагинация:** По умолчанию лимит снят (приходит весь список). Но эндпоинт готов к `limit` и `page`, если клиентов станет слишком много.
- **Новые поля в объекте:**
  - `external_uuid`: ваш переданный ID.
  - `created_at`: дата создания карточки (ISO 8601).
  - `updated_at`: дата последнего изменения (ISO 8601).
  - `net_worth`: текущий чистый капитал клиента (на основе активов).

## 3. Редактирование клиента
Эндпоинт: `PUT /api/client/:id`
- **Метод:** PUT
- **Тело запроса:** Аналогично `/first-run` (объект с полями `client`, `assets`, `liabilities`, `expenses`, `goals`).
- **Логика:** При вызове бэкенд полностью обновляет профиль и перезаписывает связанные сущности (активы, цели).
- **Пример:** Если нужно изменить только телефон, отправьте объект `client` с новым телефоном. Если изменился состав активов — пришлите новый массив `assets`.

## 4. Карта клиента (Get)
Эндпоинт: `GET /api/client/:id`
- Теперь возвращает полную информацию, включая `created_at` и `updated_at`. Используйте их для отображения в футере карточки или в списке ("Изменен 2 часа назад").

---
**Важно:** Для всех защищенных запросов по-прежнему требуется заголовок `x-api-key`.
